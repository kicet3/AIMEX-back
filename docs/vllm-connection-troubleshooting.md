# vLLM μ„λ²„ μ—°κ²° λ¬Έμ  ν•΄κ²° κ°€μ΄λ“

## λ¬Έμ  μ¦μƒ
- νμΈνλ‹ μ¬μ‹μ‘ μ‹ λΉ μ—λ¬ λ©”μ‹μ§€μ™€ ν•¨κ» μ‹¤ν¨
- "vLLM μ„λ²„ μ—°κ²° μ‹¤ν¨" λ΅κ·Έ λ©”μ‹μ§€
- νμΈνλ‹μ΄ μλ™μΌλ΅ μ‹μ‘λμ§€ μ•μ

## ν•΄κ²° λ°©λ²•

### 1. ν™κ²½ λ³€μ ν™•μΈ

`.env` νμΌμ—μ„ λ‹¤μ μ„¤μ •μ„ ν™•μΈν•μ„Έμ”:

```env
# vLLM μ„λ²„ μ„¤μ •
VLLM_ENABLED=true
VLLM_SERVER_URL=https://your-runpod-url.runpod.net  # RunPod URL λλ” λ΅μ»¬ μ„λ²„ URL

# λ΅μ»¬ μ„λ²„ μ‚¬μ© μ‹ (VLLM_SERVER_URLμ΄ μ„¤μ •λμ§€ μ•μ€ κ²½μ°)
VLLM_HOST=localhost
VLLM_PORT=8000
VLLM_TIMEOUT=300
```

### 2. vLLM μ„λ²„ μƒνƒ ν™•μΈ

#### RunPod μ‚¬μ© μ‹
1. RunPod λ€μ‹λ³΄λ“μ—μ„ μΈμ¤ν„΄μ¤κ°€ μ‹¤ν–‰ μ¤‘μΈμ§€ ν™•μΈ
2. μ κ³µλ μ—”λ“ν¬μΈνΈ URLμ΄ μ¬λ°”λ¥Έμ§€ ν™•μΈ
3. λ°©ν™”λ²½μ΄λ‚ λ„¤νΈμ›ν¬ μ ν•μ΄ μ—†λ”μ§€ ν™•μΈ

#### λ΅μ»¬ μ„λ²„ μ‚¬μ© μ‹
```bash
# vLLM μ„λ²„κ°€ μ‹¤ν–‰ μ¤‘μΈμ§€ ν™•μΈ
curl http://localhost:8000/

# λλ” λΈλΌμ°μ €μ—μ„ μ§μ ‘ μ ‘μ†
http://localhost:8000/
```

### 3. λ΅κ·Έ ν™•μΈ

λ°±μ—”λ“ λ΅κ·Έμ—μ„ λ‹¤μκ³Ό κ°™μ€ λ©”μ‹μ§€λ¥Ό ν™•μΈν•μ„Έμ”:

```
π” vLLM μ„λ²„ μ—°κ²° λ€κΈ° μ¤‘...
β³ vLLM μ„λ²„ μ—°κ²° μ‹¤ν¨, 5μ΄ ν›„ μ¬μ‹λ„... (1/6)
β vLLM μ„λ²„ μ—°κ²° μ‹¤ν¨ (ConnectError): https://your-url.runpod.net
   - μƒμ„Έ μ¤λ¥: [μ¤λ¥ λ©”μ‹μ§€]
   - ν™κ²½ λ³€μ ν™•μΈ: VLLM_ENABLED=true, VLLM_SERVER_URL=https://...
```

### 4. μΌλ°μ μΈ λ¬Έμ μ™€ ν•΄κ²°μ±…

#### λ¬Έμ : Connection refused
**μ›μΈ**: vLLM μ„λ²„κ°€ μ‹¤ν–‰λμ§€ μ•μ•κ±°λ‚ ν¬νΈκ°€ μλ»λ¨
**ν•΄κ²°**: 
- vLLM μ„λ²„ μ‹μ‘ ν™•μΈ
- ν¬νΈ λ²νΈ ν™•μΈ (κΈ°λ³Έκ°’: 8000)

#### λ¬Έμ : Timeout
**μ›μΈ**: λ„¤νΈμ›ν¬ μ§€μ—° λλ” μ„λ²„ μ‘λ‹µ μ§€μ—°
**ν•΄κ²°**: 
- `VLLM_TIMEOUT` κ°’ μ¦κ°€ (μ: 600)
- λ„¤νΈμ›ν¬ μ—°κ²° μƒνƒ ν™•μΈ

#### λ¬Έμ : 404 Not Found
**μ›μΈ**: μλ»λ URL κ²½λ΅
**ν•΄κ²°**: 
- `VLLM_SERVER_URL`μ΄ μ¬λ°”λ¥Έμ§€ ν™•μΈ
- λμ— μ¬λμ‹(/)κ°€ μ—†λ”μ§€ ν™•μΈ

### 5. λ””λ²„κΉ… λ‹¨κ³„

1. **μ§μ ‘ μ—°κ²° ν…μ¤νΈ**
   ```bash
   # PythonμΌλ΅ μ§μ ‘ ν…μ¤νΈ
   python -c "
   import httpx
   import asyncio
   
   async def test():
       async with httpx.AsyncClient() as client:
           try:
               response = await client.get('YOUR_VLLM_URL_HERE')
               print(f'Status: {response.status_code}')
               print(f'Response: {response.text[:200]}')
           except Exception as e:
               print(f'Error: {type(e).__name__}: {e}')
   
   asyncio.run(test())
   "
   ```

2. **ν™κ²½ λ³€μ μ¶λ ¥**
   ```bash
   # ν„μ¬ μ„¤μ •λ ν™κ²½ λ³€μ ν™•μΈ
   grep VLLM .env
   ```

3. **μ„λ²„ μ¬μ‹μ‘**
   ```bash
   # λ°±μ—”λ“ μ„λ²„ μ¬μ‹μ‘
   # Docker μ‚¬μ© μ‹
   docker-compose restart backend
   
   # μ§μ ‘ μ‹¤ν–‰ μ‹
   # Ctrl+Cλ΅ μ¤‘μ§€ ν›„ λ‹¤μ‹ μ‹μ‘
   uvicorn app.main:app --reload
   ```

### 6. μ„μ‹ ν•΄κ²°μ±…

vLLM μ„λ²„ μ—°κ²° λ¬Έμ κ°€ μ§€μ†λλ” κ²½μ°:

1. **μλ™ νμΈνλ‹ λΉ„ν™μ„±ν™”**
   ```env
   AUTO_FINETUNING_ENABLED=false
   ```

2. **μλ™μΌλ΅ νμΈνλ‹ μ‹μ‘**
   - λ°±μ—”λ“ APIλ¥Ό ν†µν•΄ μλ™μΌλ΅ νμΈνλ‹ μ‹μ‘
   - λλ” vLLM μ„λ²„κ°€ μ •μƒν™”λ ν›„ μ„λ²„ μ¬μ‹μ‘

### 7. λ΅κ·Έ λ λ²¨ μƒμ„Έ μ„¤μ •

λ” μμ„Έν• λ””λ²„κΉ…μ„ μ„ν•΄ λ΅κ·Έ λ λ²¨μ„ DEBUGλ΅ μ„¤μ •:

```env
LOG_LEVEL=DEBUG
DEBUG=true
```

μ΄λ ‡κ² ν•λ©΄ λ” μƒμ„Έν• μ—°κ²° μ •λ³΄λ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤.